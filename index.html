<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>digremoji</title>


    <style>
        body {
            font-family: sans-serif;
        }

        body * {
            margin: 6px;
        }

        p {
            font-size: 1.2em;
        }

        button, input, label {
            padding: 10px;
            font-size: 1.4em;
        }

        textarea {
            width: 90%;
            height: 180px;
            font-size: 2em;
        }
    </style>
</head>
<body>
<h1>Digremoji</h1>
<p>A digraphic substitution cipher. <a href="https://github.com/FoamyGuy/Digremoji_Page/blob/main/README.md">Learn
    More</a></p>
<textarea id="messageInput" placeholder="Plain Text Message"></textarea>
<br>
<button id="encodeBtn" title="Encode">TXT -&gt; ðŸ˜€</button>
<button id="decodeBtn" title="Decode">ðŸ˜€ -&gt; TXT</button>
<label title="seed">ðŸŒ± : </label><input id="seedInput" title="seed" type="number" value="0">
<button title="Random seed" id="shuffleBtn">ðŸŽ²ðŸ”‘</button>

<br>
<textarea id="outputText" placeholder="Digremoji Cipher Text"></textarea>


<script>
    const chunk = (arr, size) =>
        Array.from({length: Math.ceil(arr.length / size)}, (v, i) =>
            arr.slice(i * size, i * size + size)
        );


    function shuffleArray(array, seed) {

        console.log("inside shuffle seed is: " + seed);

        function splitmix32(a) {
            return function () {
                a |= 0;
                a = a + 0x9e3779b9 | 0;
                let t = a ^ a >>> 16;
                t = Math.imul(t, 0x21f0aaad);
                t = t ^ t >>> 15;
                t = Math.imul(t, 0x735a2d97);
                return ((t = t ^ t >>> 15) >>> 0) / 4294967296;
            }
        }

        const prng = splitmix32(seed);

        for (let i = array.length - 1; i > 0; i--) {
            const j = Math.floor(prng() * (i + 1));
            [array[i], array[j]] = [array[j], array[i]];
        }
    }


    let $encodeBtn = document.querySelector("#encodeBtn");
    let $decodeBtn = document.querySelector("#decodeBtn");
    let $messageInput = document.querySelector("#messageInput");
    let $outputText = document.querySelector("#outputText");
    let $seedInput = document.querySelector("#seedInput");
    let $shuffleBtn = document.querySelector("#shuffleBtn");


    const englishAlphabetStr = "ABCDEFGHIJKLMNOPQRSTUVWXYZ ";
    const emojiAlphabetStr = "ðŸ®ðŸš£ðŸšðŸ›¶ðŸ˜ºðŸ“¢ðŸšðŸ˜•ðŸš©ðŸ›‘ðŸ£ðŸ˜ŒðŸ•¡ðŸ¥ðŸ–¤ðŸ“‹ðŸ’³ðŸ’€ðŸ˜¤ðŸ‘ðŸˆðŸ•”ðŸ”ºðŸ’«ðŸŽˆðŸŽ‡ðŸ“¡ðŸ‘€ðŸ’ðŸ–ðŸ”©ðŸ“¥ðŸ€ðŸ·ðŸ˜˜ðŸ™ŠðŸ’­ðŸ˜ƒðŸ›ðŸ±ðŸš­ðŸ˜­ðŸ“ðŸžðŸ‰ðŸ”ˆðŸ›–ðŸ’ŸðŸš›ðŸ¤¥ðŸ““ðŸ«ðŸ‘¼ðŸ›¹ðŸ’ªðŸŽ‚ðŸ•ðŸ˜žðŸªðŸŽ®ðŸðŸ“µðŸ‰ðŸš‡ðŸ”ðŸ˜¦ðŸ”„ðŸ’ðŸ“¦ðŸ˜¥ðŸ˜„ðŸšðŸ“ºðŸ‘ŠðŸŽµðŸ™ƒðŸ’‹ðŸ‘œðŸ˜¯ðŸ˜ðŸ¢ðŸ•’ðŸ•‘ðŸ“‰ðŸ‘¸ðŸ“ðŸ’©ðŸš¼ðŸ”¢ðŸ˜ðŸ’“ðŸŽ¥ðŸðŸ‘³ðŸš¯ðŸŒ¹ðŸŽ·ðŸš¥ðŸŒ€ðŸ”¬ðŸ”ðŸŒŸðŸ”ðŸ¸ðŸ˜¬ðŸ¤¡ðŸ¤ðŸ•ðŸ˜…ðŸ’ðŸ£ðŸ˜™ðŸ‘–ðŸš«ðŸˆðŸ˜«ðŸ©ðŸ¢ðŸ‡ðŸŽ³ðŸƒðŸš’ðŸšŒðŸ’„ðŸ›»ðŸŽ¢ðŸ˜°ðŸ‘µðŸ”ðŸ˜ˆðŸ‘¿ðŸ”‚ðŸŒ…ðŸ˜½ðŸ™‹ðŸ…ðŸ¹ðŸš„ðŸ¯ðŸ™„ðŸžðŸ—¿ðŸ“„ðŸ” ðŸ’ŽðŸ“´ðŸ™‚ðŸŽ¶ðŸ”˜ðŸš°ðŸš˜ðŸ“ðŸºðŸ’ŠðŸ’¹ðŸŽ¯ðŸš¸ðŸ¶ðŸ¬ðŸ“¸ðŸ’¼ðŸ›ƒðŸ”±ðŸŽ²ðŸ”­ðŸ‘²ðŸŒœðŸ’ðŸ˜ªðŸ€ðŸŒ‹ðŸ¤—ðŸ‘ðŸ“•ðŸ±ðŸ¾ðŸ®ðŸ”…ðŸ•§ðŸ’‰ðŸ’ðŸ’ŒðŸ˜šðŸ©ðŸ˜‰ðŸŸ°ðŸ¦ðŸ“³ðŸ´ðŸ”—ðŸ‘ªðŸ“¶ðŸ“‚ðŸ“¿ðŸ’§ðŸš€ðŸ“»ðŸ‘§ðŸ“”ðŸ˜‹ðŸ’šðŸ˜¹ðŸ¬ðŸ‘¾ðŸ·ðŸš¿ðŸ¨ðŸ›ŸðŸ”´ðŸ¹ðŸœðŸ ðŸŽªðŸ™†ðŸ›„ðŸ³ðŸŽ¦ðŸ•ðŸ¥ðŸ’˜ðŸ’¥ðŸŒ™ðŸ“·ðŸ»ðŸ˜ðŸ‘‹ðŸŒðŸ‘šðŸ“ðŸš³ðŸ“¬ðŸ¼ðŸŒðŸ¢ðŸ”“ðŸ…ðŸ’ºðŸ˜ŽðŸ›•ðŸ…ðŸŽðŸ’»ðŸš½ðŸ“¤ðŸ––ðŸðŸ‘‡ðŸŽ‘ðŸ˜§ðŸŒŽðŸ˜ŠðŸ”µðŸ”ƒðŸš²ðŸ’–ðŸšŸðŸ¤”ðŸ’ˆðŸ‚ðŸš¡ðŸ‘ðŸ“®ðŸ¤ ðŸŒ–ðŸ¨ðŸ­ðŸ˜´ðŸŽ´ðŸƒðŸ”’ðŸŽ†ðŸƒðŸ¡ðŸ—¾ðŸŒ´ðŸ‘“ðŸ—½ðŸ°ðŸ°ðŸ¤žðŸšµðŸ“°ðŸ™…ðŸ˜œðŸš‘ðŸ’…ðŸ”™ðŸ•™ðŸ¯ðŸ‘¯ðŸŽŽðŸ“™ðŸ‘¦ðŸ˜ðŸ˜¡ðŸ•¤ðŸš¤ðŸ‡ðŸŽ‰ðŸ´ðŸ¤’ðŸ“ðŸ¤ŸðŸš¬ðŸš‹ðŸšðŸ›ðŸ”£ðŸ¤˜ðŸ”€ðŸ¤œðŸ¤ðŸ¾ðŸš¾ðŸ’¨ðŸ‘ðŸ¸ðŸ“ðŸŽ»ðŸŒˆðŸ¤ðŸ“²ðŸ­ðŸ‘‚ðŸ’¯ðŸ‘¨ðŸ”·ðŸŽ¸ðŸ‚ðŸ¦ðŸ‘¹ðŸ—»ðŸ“§ðŸ‚ðŸ‘«ðŸ¥ðŸ›—ðŸŽ¹ðŸðŸðŸ‘•ðŸ“žðŸŽ¨ðŸ¤ðŸšŽðŸŽ§ðŸ›ðŸ”»ðŸ‘»ðŸš¦ðŸ’´ðŸ‰ðŸ•ºðŸ¤ðŸ“ƒðŸ§ðŸ’¸ðŸ“…ðŸŽºðŸŒ‚ðŸ”‹ðŸ”«ðŸ›·ðŸ”šðŸŒ¾ðŸŒ ðŸ¿ðŸ˜”ðŸ—ðŸ•ŽðŸ•‹ðŸš¢ðŸ˜©ðŸŒðŸ‘ˆðŸ“£ðŸ‘£ðŸ”ªðŸ”¤ðŸ“­ðŸšˆðŸŽðŸŸðŸ”ðŸ“†ðŸ•ŸðŸ²ðŸ•šðŸŒƒðŸ™ðŸŽðŸ”œðŸ˜“ðŸµðŸ’±ðŸ‘”ðŸªðŸ’¤ðŸ ðŸš´ðŸ”–ðŸ›«ðŸ‘¢ðŸ™ðŸ¬ðŸ‘„ðŸ‘‘ðŸ“’ðŸ‘ðŸ’ðŸ’£ðŸ’¾ðŸªðŸŽðŸ˜³ðŸ‘†ðŸ“˜ðŸ°ðŸ˜·ðŸ‡ðŸ‘˜ðŸ••ðŸŒ˜ðŸ®ðŸŽ­ðŸ¤£ðŸŒðŸ’¬ðŸ•ðŸ’ðŸ“–ðŸ”ðŸšðŸ«ðŸ˜¶ðŸ“ŸðŸ›œðŸŽðŸ“‘ðŸ‘ŒðŸ“¹ðŸ™ˆðŸ’²ðŸ«ðŸ›¸ðŸŽðŸŒ‘ðŸ™‡ðŸ•£ðŸ‘®ðŸºðŸ¡ðŸ“ŒðŸ¤šðŸ¼ðŸ•¦ðŸ²ðŸŽ„ðŸš‰ðŸ™ðŸ”°ðŸš—ðŸ”¨ðŸŽ“ðŸ­ðŸ˜ðŸšœðŸ“šðŸŽ¾ðŸ§ðŸŒ²ðŸðŸ˜†ðŸ“ðŸŽ’ðŸŽ¡ðŸðŸ§ðŸ˜ðŸ¹ðŸ¤¤ðŸ”›ðŸ™ŽðŸ”ŸðŸ‘’ðŸšŠðŸ˜¿ðŸ’ƒðŸ’µðŸ¤ðŸ˜ŸðŸ¤“ðŸ„ðŸ”®ðŸ’”ðŸ”²ðŸŒ³ðŸ—ðŸ˜›ðŸ“¯ðŸ’ðŸ•œðŸ”ŒðŸ”ðŸðŸ“ªðŸ›€ðŸ³ðŸ¤ðŸ’›ðŸ—¼ðŸ’œðŸ’°ðŸ‘¬ðŸŠðŸ†ðŸ‘¥ðŸš®ðŸ‘ƒðŸŽŠðŸ’‡ðŸ›ŒðŸšºðŸ’¦ðŸ˜ðŸðŸ›µðŸ‘ðŸ’®ðŸ”•ðŸ“¼ðŸ˜£ðŸŽ€ðŸ•–ðŸ‘¶ðŸš¹ðŸ¤ŽðŸ‘—ðŸ“ŠðŸ”§ðŸ˜’ðŸ˜»ðŸ˜¸ðŸ’¢ðŸ”¼ðŸ”¦ðŸŽ©ðŸŒ•ðŸ˜®ðŸ¸ðŸŒ°ðŸ¯ðŸ©ðŸ“›ðŸŽ¿ðŸ’·ðŸ“—ðŸ›¬ðŸ›´ðŸ“ ðŸ˜‡ðŸŽ ðŸ’’ðŸ˜ ðŸ”½ðŸš–ðŸš»ðŸŒ’ðŸŒ—ðŸ‘¤ðŸ’žðŸ‘·ðŸŒðŸ‘ŸðŸ‘´ðŸ¤¢ðŸŒ»ðŸ¶ðŸ„ðŸ“œðŸš‚ðŸŽ¼ðŸ• ðŸ‘°ðŸ†ðŸ’‚ðŸŒ·ðŸ“©ðŸš“ðŸŒ“ðŸŽŒðŸŽ¤ðŸŒ¯ðŸ‘­ðŸ‘¡ðŸšžðŸŒðŸ™ðŸ›ðŸ–•ðŸŽ…ðŸðŸ”¯ðŸ¤‘ðŸ•¥ðŸšƒðŸ¤–ðŸŒ¸ðŸŒŠðŸ’¶ðŸœðŸ¨ðŸ ðŸ›‚ðŸ¤›ðŸ•“ðŸ”‰ðŸšªðŸŸðŸ•ðŸŒºðŸŽ¬ðŸŒ½ðŸŒŒðŸ‘ ðŸš”ðŸŽ£ðŸ‘©ðŸ“ŽðŸ”¸ðŸ›¼ðŸŒ±ðŸ˜¢ðŸ»ðŸ‘™ðŸ˜µðŸ•›ðŸŒ„ðŸ•ŒðŸ“¨ðŸš¶ðŸ‘ŽðŸ„ðŸ™€ðŸŒ¼ðŸ‘›ðŸŒ¿ðŸ’—ðŸŽ°ðŸŒ”ðŸŒ®ðŸ˜—ðŸ”¶ðŸ“‡ðŸ•žðŸŽ‹ðŸš§ðŸ”†ðŸ¡ðŸšðŸ™ŒðŸŒšðŸš ðŸš…ðŸŠðŸš™ðŸ”‘ðŸš·ðŸ˜¾ðŸ‘…ðŸ”¹ðŸŒ›ðŸ˜±ðŸ‘±ðŸ›’ðŸ–ðŸ’™ðŸ“€ðŸ”¥ðŸ¤ŒðŸŽ±ðŸ›žðŸŒ‰ðŸ˜€ðŸŽƒðŸ‘‰ðŸ•—ðŸŒ†ðŸ”¡ðŸš±ðŸ”žðŸðŸ’‘ðŸ”ŠðŸ½ðŸ’†ðŸŽ«ðŸ¤•ðŸˆðŸ’•ðŸŒðŸðŸ£ðŸ“ðŸ”ŽðŸ¤™ðŸŒ‡ðŸ›ºðŸ“ˆðŸ˜‘ðŸš†ðŸ˜–ðŸ›ðŸ“«ðŸ†ðŸ´ðŸš¨ðŸ‘žðŸ›…ðŸðŸŽ½ðŸ•˜ðŸ™ðŸŒ­ðŸ™‰ðŸŒµðŸ”³ðŸ˜²ðŸ˜¼ðŸŠðŸšðŸ’ ðŸ’½ðŸ‹ðŸ‘ºðŸ‹ðŸ’¿ðŸ”‡ðŸ‘ðŸš•ðŸ’¡ðŸŒžðŸ“±ðŸºðŸ‘½ðŸššðŸ¦ðŸ˜‚ðŸ•¢ðŸ˜¨";
    let emojiAlphabetList = chunk(emojiAlphabetStr, 2);
    let emojiMap = {}

    $shuffleBtn.addEventListener("click", function (event) {
        $seedInput.value = (Math.random() * 2 ** 32) >>> 0
        emojiAlphabetList = chunk(emojiAlphabetStr, 2);
        shuffleArray(emojiAlphabetList, parseInt($seedInput.value));
        $encodeBtn.click();
    });

    $seedInput.addEventListener("blur", function (event) {
        console.log("seed input blur");
    });

    $seedInput.addEventListener("change", function (event) {
        console.log("seed input change");
        if ($seedInput.value === "0") {
            emojiAlphabetList = chunk(emojiAlphabetStr, 2);
            //$encodeBtn.click();
        } else {
            emojiAlphabetList = chunk(emojiAlphabetStr, 2);
            shuffleArray(emojiAlphabetList, parseInt($seedInput.value));
            if ($messageInput.value !== "") {
                $encodeBtn.click();
            }

        }
    })


    function buildMap(alphabetList) {
        emojiMap = {};
        let curEmojiIndex = 0
        for (let firstIndex = 0; firstIndex < englishAlphabetStr.length; firstIndex++) {
            for (let secondIndex = 0; secondIndex < englishAlphabetStr.length; secondIndex++) {
                emojiMap[englishAlphabetStr[firstIndex] + englishAlphabetStr[secondIndex]] = alphabetList[curEmojiIndex];
                emojiMap[alphabetList[curEmojiIndex]] = englishAlphabetStr[firstIndex] + englishAlphabetStr[secondIndex];
                curEmojiIndex++;
            }
        }
    }

    function encrypt(plainText) {
        cipherTextList = [];
        plainTextList = plainText.split("");
        if (plainTextList.length % 2 == 1) {
            plainTextList.push(" ");
        }

        buildMap(emojiAlphabetList);
        //console.log(emojiMap);

        let plainTextDigrams = chunk(plainTextList, 2);
        for (let i = 0; i < plainTextDigrams.length; i++) {
            const curDigram = plainTextDigrams[i].join("");
            //console.log("cur digram: " + curDigram);
            cipherTextList.push(emojiMap[curDigram])
        }

        return cipherTextList.join("");
    }

    function decrypt(cipherText) {
        cipherTextList = chunk(cipherText, 2);
        plainTextList = []

        buildMap(emojiAlphabetList);

        for (let i = 0; i < cipherTextList.length; i++) {
            const curDigram = emojiMap[cipherTextList[i]]
            //console.log("cur digram: " + curDigram);
            plainTextList.push(curDigram)
        }

        return plainTextList.join("");
    }


    $encodeBtn.addEventListener("click", function (event) {
        $outputText.value = encrypt($messageInput.value.toUpperCase());
    });
    $decodeBtn.addEventListener("click", function (event) {
        $messageInput.value = decrypt($outputText.value).toLocaleLowerCase();
    });

    $messageInput.addEventListener('keypress', function (e) {
        if (e.key === 'Enter') {
            $encodeBtn.click();
        }
    });

    $outputText.addEventListener('keypress', function (e) {
        if (e.key === 'Enter') {
            $decodeBtn.click();
        }
    });

</script>
</body>
</html>